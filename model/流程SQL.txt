DROP TABLE IF EXISTS public_flow_main_tbl;
CREATE TABLE public_flow_main_tbl(
    op_id VARCHAR(32),
    key_code VARCHAR(255),
    is_stop INTEGER,
    flow_desc VARCHAR(255),
    main_type INTEGER,
    main_name VARCHAR(255),
    create_user_id VARCHAR(32),
    create_user_name VARCHAR(255),
    create_time TIMESTAMP,
    org_id VARCHAR(255),
    dept_id VARCHAR(255)
);

COMMENT ON TABLE public_flow_main_tbl IS '流程主表';
COMMENT ON COLUMN public_flow_main_tbl.op_id IS '主键';
COMMENT ON COLUMN public_flow_main_tbl.key_code IS '关键字';
COMMENT ON COLUMN public_flow_main_tbl.is_stop IS '是否启用;1:启用;0:不启用';
COMMENT ON COLUMN public_flow_main_tbl.flow_desc IS '描述';
COMMENT ON COLUMN public_flow_main_tbl.main_type IS '类型';
COMMENT ON COLUMN public_flow_main_tbl.main_name IS '流程名称';
COMMENT ON COLUMN public_flow_main_tbl.create_user_id IS '创建人主键';
COMMENT ON COLUMN public_flow_main_tbl.create_user_name IS '创建人姓名';
COMMENT ON COLUMN public_flow_main_tbl.create_time IS '创建时间';
COMMENT ON COLUMN public_flow_main_tbl.org_id IS '机构主键';
COMMENT ON COLUMN public_flow_main_tbl.dept_id IS '科室id';

DROP TABLE IF EXISTS public_flow_node_tbl;
CREATE TABLE public_flow_node_tbl(
    op_id VARCHAR(32),
    main_id VARCHAR(32),
    last_node_id VARCHAR(32),
    last_node_key VARCHAR(255),
    limit_time INTEGER,
    next_node text,
    node_name VARCHAR(255),
    node_key VARCHAR(255),
    node_type VARCHAR(255),
    node_sort INTEGER,
    node_status INTEGER,
    check_type VARCHAR(255),
    primary key (op_id)
);

COMMENT ON TABLE public_flow_node_tbl IS '环节表';
COMMENT ON COLUMN public_flow_node_tbl.op_id IS '主键';
COMMENT ON COLUMN public_flow_node_tbl.main_id IS '流程主表id';
COMMENT ON COLUMN public_flow_node_tbl.last_node_id IS '上一个环节';
COMMENT ON COLUMN public_flow_node_tbl.last_node_key IS '上一个环节key';
COMMENT ON COLUMN public_flow_node_tbl.limit_time IS '限制时间,单位天';
COMMENT ON COLUMN public_flow_node_tbl.next_node IS '下一个环节(json配置);下一个环节
[{
"key":"",
"nextNodeId":"",
"nextNodeKey":""
}]';
COMMENT ON COLUMN public_flow_node_tbl.node_name IS '当前环节名称';
COMMENT ON COLUMN public_flow_node_tbl.node_key IS '当前环节key;关键字
start开始;
ing:中间环节;
或者其他指定的key也表示中间环节
;end结束;';
COMMENT ON COLUMN public_flow_node_tbl.node_type IS '看说明;1:创建;2:常规;3:等待多人审批;100:结束归档';
COMMENT ON COLUMN public_flow_node_tbl.node_sort IS '节点排序：1,2,3,4';
COMMENT ON COLUMN public_flow_node_tbl.node_status IS '1:开始;2:常规节点;10:结束';
COMMENT ON COLUMN public_flow_node_tbl.check_type IS '看说明;审批类型,可能为1,2,3;1:人员;2:部门;3:角色;可能为多个值';

DROP TABLE IF EXISTS public_flow_node_check_tbl;
CREATE TABLE public_flow_node_check_tbl(
    op_id VARCHAR(32) NOT NULL,
    create_time TIMESTAMP,
    node_op_id VARCHAR(32),
    ref_id VARCHAR(32),
    check_type VARCHAR(255),
    类型 INTEGER,
    PRIMARY KEY (op_id)
);

COMMENT ON TABLE public_flow_node_check_tbl IS '该环节指定的人员、部门、角色id';
COMMENT ON COLUMN public_flow_node_check_tbl.node_op_id IS 'public_flow_node_tbl的主键';
COMMENT ON COLUMN public_flow_node_check_tbl.ref_id IS '根据check_type来定';
COMMENT ON COLUMN public_flow_node_check_tbl.check_type IS '审批类型,可能为1,2,3;1:人员;2:部门;3:角色';
COMMENT ON COLUMN public_flow_node_check_tbl.类型 IS '见说明;1：非会签（有一个通过就可以）；2：会签（都要审核通过）；3：依次逐个处理；4：抄送';

DROP TABLE IF EXISTS public_flow_instance_tbl;
CREATE TABLE public_flow_instance_tbl(
    op_id VARCHAR(32),
    create_time TIMESTAMP,
    end_time TIMESTAMP,
    flow_status INTEGER,
    is_over_time INTEGER,
    total_time INTEGER,
    task_op_id VARCHAR(32),
    user_appraise INTEGER,
    appraise_content text,
    main_id VARCHAR(32),
    org_id VARCHAR(32),
    dept_id VARCHAR(32),
    public_flow_comment text,
    public_flow_attachment text,
    private_flow_attachment text,
    create_user_op_id VARCHAR(32),
    PRIMARY KEY (op_id)
);

COMMENT ON TABLE public_flow_instance_tbl IS '流程实例表';
COMMENT ON COLUMN public_flow_instance_tbl.op_id IS '主键';
COMMENT ON COLUMN public_flow_instance_tbl.create_time IS '创建时间';
COMMENT ON COLUMN public_flow_instance_tbl.end_time IS '结束时间';
COMMENT ON COLUMN public_flow_instance_tbl.flow_status IS '流程状态;0:未结束;1:结束';
COMMENT ON COLUMN public_flow_instance_tbl.is_over_time IS '是否超时;0:未超时;1:超时';
COMMENT ON COLUMN public_flow_instance_tbl.total_time IS '总耗时';
COMMENT ON COLUMN public_flow_instance_tbl.task_op_id IS '绑定的业务主键';
COMMENT ON COLUMN public_flow_instance_tbl.user_appraise IS '用户评价： -1:不满意 0:基本满意 1:满意';
COMMENT ON COLUMN public_flow_instance_tbl.appraise_content IS '评价内容';
COMMENT ON COLUMN public_flow_instance_tbl.main_id IS '流程id';
COMMENT ON COLUMN public_flow_instance_tbl.org_id IS '机构id';
COMMENT ON COLUMN public_flow_instance_tbl.dept_id IS '部门id';
COMMENT ON COLUMN public_flow_instance_tbl.public_flow_comment IS '流程总体意见,也就是最终反馈的意见';
COMMENT ON COLUMN public_flow_instance_tbl.public_flow_attachment IS '附件id,多个附件用逗号风格，一个流程最多不超过30个附件；公开附件信息';
COMMENT ON COLUMN public_flow_instance_tbl.private_flow_attachment IS '附件id,多个附件用逗号风格，一个流程最多不超过30个附件；不公开附件信息';
COMMENT ON COLUMN public_flow_instance_tbl.create_user_op_id IS '创建人';


DROP TABLE IF EXISTS public_flow_instance_flow_tbl;
CREATE TABLE public_flow_instance_flow_tbl(
    op_id VARCHAR(32) NOT NULL,
    instance_id VARCHAR(32),
    task_op_id VARCHAR(32),
    create_time TIMESTAMP,
    node_id VARCHAR(32),
    node_key VARCHAR(255),
    org_id VARCHAR(32),
    dept_id VARCHAR(32),
    last_node_id VARCHAR(32),
    last_node_key VARCHAR(255),
    next_node_id VARCHAR(32),
    next_node_key text,
    operation_time TIMESTAMP,
    user_op_id text,
    last_op_id text,
    flow_status INTEGER,
    flow_result INTEGER,
    flow_comment text,
    header_comment text,
    back_comment text,
    flow_sort INTEGER,
    PRIMARY KEY (op_id)
);

COMMENT ON TABLE public_flow_instance_flow_tbl IS '流程流转表';
COMMENT ON COLUMN public_flow_instance_flow_tbl.op_id IS '主键';
COMMENT ON COLUMN public_flow_instance_flow_tbl.instance_id IS '流程实例表主键';
COMMENT ON COLUMN public_flow_instance_flow_tbl.task_op_id IS '绑定的业务主键';
COMMENT ON COLUMN public_flow_instance_flow_tbl.create_time IS '创建时间';
COMMENT ON COLUMN public_flow_instance_flow_tbl.node_id IS '环节id';
COMMENT ON COLUMN public_flow_instance_flow_tbl.org_id IS '机构id';
COMMENT ON COLUMN public_flow_instance_flow_tbl.dept_id IS '部门id';
COMMENT ON COLUMN public_flow_instance_flow_tbl.last_op_id IS '就这个表的上一个环节的主键';
COMMENT ON COLUMN public_flow_instance_flow_tbl.flow_status IS '流程状态;0:未操作;1:已操作;注意这里仅仅是是否操作过，如果不通过也是属于操作的也就是1';
COMMENT ON COLUMN public_flow_instance_flow_tbl.flow_result IS '处理结果:0:不通过;1:通过';
COMMENT ON COLUMN public_flow_instance_flow_tbl.flow_comment IS '处理意见';
COMMENT ON COLUMN public_flow_instance_flow_tbl.header_comment IS '领导处理意见';
COMMENT ON COLUMN public_flow_instance_flow_tbl.back_comment IS '回退意见';
COMMENT ON COLUMN public_flow_instance_flow_tbl.flow_sort IS '顺序';

